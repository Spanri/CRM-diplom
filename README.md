# СЭД МТУСИ :sweat_drops:

> Vue.js / Django (rest framework) проект

## Построение

### Фронтенд, Vue.js

Можно не запускать, если нужно тестить только сервер!

Не забудьте установить npm!
Для того, чтобы проходили запросы на сервер, нужно в браузере
отключить cors. Например, в firefox это можно сделать с помощью
дополнения "CORS Everywhere".
Пока что я не соединила это с сервером, поэтому надо запустить 2
сервера одновременно и зайти на [фронтенд](http://localhost:8080).

``` bash
# перейти в папку с фронтендом
cd frontend

# установить зависимости
npm install

# запустить с горячей перезагрузкой localhost:8080
npm run dev

# построить для продакшена с минификацией
npm run build

# построить для продакшена и посмотреть bundle analyzer report
npm run build --report
```

### Бекенд, Django

Не забудьте установить python!

``` bash
# установить зависимости
pip3 install -r requirements.txt

# собрать статические файлы, для того, чтобы
# запустить клиент на сервере
python manage.py collectstatic

# миграция таблиц для правильной работы с бд
python manage.py migrate

# Нужно настроить глобальные переменные (для почты, для бд, для
# хранилища амазона и так далее). Все значения секретные, поэтому
# нужно писать разработчику, если он даст - сможете протестировать.
# Ниже пример настройки глобальной переменной. Это для виндовс,
# для юниксов вместо set - export
set EDMS-MAIL-PASSWORD=password

# запустить
python manage.py runserver

# зайти в администратора (данные суперюзера или админа, который есть в
# бд (то есть если если известен аккаунт на edms-mtuci.herokuapp.com и
# он админский) или суперюзера). Первая строка - создание суперюзера
# (если нет админского аккаунта)
python manage.py createsuperuser
http://localhost:8000/api/admin/login/?next=/api/admin/

# зайти в приложение, которое фронтенд
http://localhost:8000
```
## Статусы связи документа и пользователя

Есть таблица Notif, она связывает документ и пользователя. Отношение связи показывает поле status

| Status | Что значит  
| --- |:---:|
| 0 | Владелец
| 1 | Не владелец, нужна подпись, очередь еще не подошла
| 2 | Не владелец, нужна подпись, очередь подошла
| 3 | Подпись есть, владелец подписанного документа видит уведомление
| 4 | Подпись есть, владелец подписанного документа НЕ видит уведомление
| 5 | Не владелец, подпись не нужна, может только смотреть документ
| 6 | В таблице нет, ставится при возвращении документов для конкретного пользователя тем документам, которые были подписаны этим 
пользователем (чтобы отличить от документов, которые принадлежат пользователю и находятся в уведомлениях "Ваш документ подписали.")
| 7 | Подписант отказался подписывать


## Другие штуки

[Документация на сервер](https://edms-mtuci.herokuapp.com/api/docsServer/)

[Веб-приложение](https://edms-mtuci.herokuapp.com/app) (данные для входа, чтобы потестить, спросить у разработчика)

[Панель администратора](https://edms-mtuci.herokuapp.com/api/admin/) (данные администратора спросить у разработчика, но он может и не дать их)

